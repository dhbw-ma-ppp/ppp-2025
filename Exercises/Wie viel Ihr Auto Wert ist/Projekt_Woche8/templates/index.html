<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Preisvorhersage</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <header id="top">
    <h1>ğŸš— Car Price Predictor</h1>
  </header>

  <div class="video-sticky">
  <iframe 
    src="https://www.youtube.com/embed/TeSRVSqpumo?autoplay=1&mute=1&loop=1&playlist=TeSRVSqpumo" 
    frameborder="0" 
    allow="autoplay; encrypted-media" 
    allowfullscreen>
  </iframe>
</div>

<div class="top-left-icons">
  <a href="#top" title="ZurÃ¼ck nach oben">ğŸ </a>
  <a href="http://127.0.0.1:5000/predict" title="Zur Vorhersage">ğŸ’°</a>
</div>

  <main>
    <!-- Feature Auswahl -->
    <section id="features">
      {% for feature in features %}
        <div class="feature" draggable="true" data-feature="{{ feature }}">{{ feature }}</div>
      {% endfor %}
    </section>

    <!-- Plot Grid -->
    <section class="plot-grid">
      <div class="plot-card">
        <h2>Scatter vs Price</h2>
        <div class="dropzone" id="scatter"></div>
      </div>
      <div class="plot-card">
        <h2>Histogram</h2>
        <div class="dropzone" id="histogram"></div>
      </div>
      <div class="plot-card">
        <h2>Boxplot</h2>
        <div class="dropzone" id="boxplot"></div>
      </div>
    </section>

  </main>

  <script>
    document.querySelectorAll('.feature').forEach(el => {
      el.addEventListener('dragstart', e => {
        e.dataTransfer.setData('feature', e.target.dataset.feature);
      });
    });

    document.querySelectorAll('.dropzone').forEach(zone => {
      zone.addEventListener('dragover', e => e.preventDefault());
      zone.addEventListener('drop', async e => {
        e.preventDefault();
        const feature = e.dataTransfer.getData('feature');
        const plotType = zone.id;

        zone.innerHTML = `<p>Lade ${feature} (${plotType})...</p>`;

        try {
          const response = await fetch(`/plot_image?feature=${encodeURIComponent(feature)}&plot_type=${encodeURIComponent(plotType)}`);
          if (!response.ok) {
            zone.innerHTML = `<p>Fehler: ${await response.text()}</p>`;
            return;
          }
          const blob = await response.blob();
          const url = URL.createObjectURL(blob);
          zone.innerHTML = `<img src="${url}" class="plot-img">`;
        } catch (err) {
          zone.innerHTML = `<p>Fehler beim Laden: ${err}</p>`;
        }
      });
    });
  </script>

  <h1>Tree Plot</h1>
  <img src="{{ url_for('plot_trees') }}" alt="Trees">

  <h1>Plot des Tree Ergebnisses</h1>
  <img src="{{ url_for('plot_predictions_tree') }}" alt="Predictions_tree" class="model-img">

  <h1>Plot des Random Forrest Ergebnisses</h1>
  <img src="{{ url_for('plot_predictions') }}" alt="Predictions" class="model-img">
</body>

  <div class="fixed-bottom">
  <a href="https://www.tegfcu.com/wp-content/uploads/2019/10/mgn_1280x720_90731c00-mezos1-e1624558370603.jpg">Impressum</a>
  <a href="https://www.youtube.com/watch?v=SpT7p7QbhxA">Ãœber uns</a>
  </div>


</html>