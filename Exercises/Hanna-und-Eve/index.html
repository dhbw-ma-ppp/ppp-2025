<!DOCTYPE html>
<html>
<body>
<h2>Kamera</h2>

<video id="video" autoplay playsinline width="400"></video>
<button id="captureBtn">Foto aufnehmen</button>
<canvas id="canvas" width="400" height="300" style="display:none;"></canvas>

<script>
// Kamera starten
navigator.mediaDevices.getUserMedia({ video: true })
    .then(stream => {
        document.getElementById("video").srcObject = stream;
    })
    .catch(err => console.error("Kamera Fehler:", err));

// Button-Event: nur hier wird das Bild aufgenommen und geschickt
document.getElementById("captureBtn").onclick = async function () {
    const video = document.getElementById("video");
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    // Bild aufnehmen
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
    const dataURL = canvas.toDataURL("image/png");

    // Bild an FastAPI schicken
    const response = await fetch("http://localhost:5000/website", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ image: dataURL })
    });

    const result = await response.json();
    alert("Python sagt: " + result.message);
};
</script>

</body>
</html>
